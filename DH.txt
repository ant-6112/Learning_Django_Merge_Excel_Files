import os
import zipfile
import xml.etree.ElementTree as ET
import wx

class Mywin(wx.Frame): 
   def __init__(self, parent, title): 
      super(Mywin, self).__init__(parent, title = title, size = (250,150)) 
      panel = wx.Panel(self) 
      box = wx.BoxSizer(wx.VERTICAL) 

      self.path = wx.TextCtrl(panel) 
      box.Add(self.path, flag = wx.EXPAND|wx.ALL, border = 10) 

      self.find = wx.TextCtrl(panel) 
      box.Add(self.find, flag = wx.EXPAND|wx.ALL, border = 10) 

      self.replace = wx.TextCtrl(panel) 
      box.Add(self.replace, flag = wx.EXPAND|wx.ALL, border = 10) 

      self.button = wx.Button(panel, -1, "Start", size = (50,50)) 
      self.button.Bind(wx.EVT_BUTTON, self.OnClicked) 
      box.Add(self.button, 0, flag = wx.ALIGN_CENTER) 

      panel.SetSizer(box) 
      self.Centre() 
      self.Show(True) 

   def OnClicked(self, event): 
      path = self.path.GetValue() 
      find = self.find.GetValue() 
      replace = self.replace.GetValue() 
      self.find_and_replace(path, find, replace)

   def find_and_replace(self, path, find, replace):
      with zipfile.ZipFile(path, 'r') as myzip:
         for filename in myzip.namelist():
            if filename.endswith('.xml'):
               with myzip.open(filename) as myfile:
                  tree = ET.parse(myfile)
                  root = tree.getroot()
                  for elem in root.iter():
                     if elem.text == find:
                        elem.text = replace
                  tree.write(filename)
      with zipfile.ZipFile(path, 'w') as myzip:
         for filename in os.listdir('.'):
            if filename.endswith('.xml'):
               myzip.write(filename)

app = wx.App() 
Mywin(None, 'Find and Replace in XML') 
app.MainLoop() 
