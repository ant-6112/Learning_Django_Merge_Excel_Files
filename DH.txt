import os
import glob
import pandas as pd

def combine_csv_files(folder_path, output_file):
    # Create an empty list to store the combined data
    combined_data = []

    # Find all CSV files in the folder that contain "_log_" in their names
    csv_files = glob.glob(os.path.join(folder_path, "*_log_*.csv"))

    if not csv_files:
        print("No CSV files found in the specified folder.")
        return

    # Iterate over the CSV files
    for file_path in csv_files:
        try:
            # Read the CSV file into a DataFrame
            data = pd.read_csv(file_path)

            # Append the data to the combined_data list
            combined_data.append(data)

        except pd.errors.EmptyDataError:
            print(f"Skipping empty file: {os.path.basename(file_path)}")
        except pd.errors.ParserError as e:
            print(f"Error parsing file: {os.path.basename(file_path)}, {e}")

    if not combined_data:
        print("No valid CSV files found.")
        return

    # Concatenate all the DataFrames into a single DataFrame
    combined_df = pd.concat(combined_data, ignore_index=True)

    # Write the combined DataFrame to a new CSV file
    combined_df.to_csv(output_file, index=False)
    print(f"Combined CSV file saved as: {output_file}")

# Prompt the user for the folder path
folder_path = input("Enter the folder path: ")

# Prompt the user for the output file name
output_file = input("Enter the output file name (with .csv extension): ")

# Call the function to combine the CSV files
combine_csv_files(folder_path, output_file)