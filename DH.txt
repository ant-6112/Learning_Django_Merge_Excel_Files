import wx
import os

class MainFrame(wx.Frame):
    def __init__(self):
        super().__init__(parent=None, title="HSS Monthly Activity")
        self.SetSize(400, 200)

        panel = wx.Panel(self)
        main_sizer = wx.BoxSizer(wx.VERTICAL)

        # Download Path
        download_path_sizer = wx.BoxSizer(wx.HORIZONTAL)
        download_path_label = wx.StaticText(panel, label="Download Path:")
        self.download_path_text = wx.TextCtrl(panel)
        download_path_button = wx.Button(panel, label="Browse")
        download_path_button.Bind(wx.EVT_BUTTON, self.on_browse)
        download_path_sizer.Add(download_path_label, 0, wx.ALL, 5)
        download_path_sizer.Add(self.download_path_text, 1, wx.EXPAND | wx.ALL, 5)
        download_path_sizer.Add(download_path_button, 0, wx.ALL, 5)

        # Buttons
        button_sizer = wx.BoxSizer(wx.HORIZONTAL)
        self.execute_button = wx.Button(panel, label="Execute")
        self.execute_button.Bind(wx.EVT_BUTTON, self.on_execute)
        self.send_mail_button = wx.Button(panel, label="Sending Mail")
        self.send_mail_button.Disable()
        button_sizer.Add(self.execute_button, 0, wx.ALL, 5)
        button_sizer.Add(self.send_mail_button, 0, wx.ALL, 5)

        main_sizer.Add(download_path_sizer, 0, wx.EXPAND | wx.ALL, 5)
        main_sizer.Add(button_sizer, 0, wx.ALIGN_CENTER | wx.ALL, 5)

        panel.SetSizer(main_sizer)

    def on_browse(self, event):
        dialog = wx.DirDialog(self, "Choose a directory")
        if dialog.ShowModal() == wx.ID_OK:
            self.download_path_text.SetValue(dialog.GetPath())
        dialog.Destroy()

    def on_execute(self, event):
        # Execution logic goes here
        print("Execute button clicked")
        self.send_mail_button.Enable()

if __name__ == "__main__":
    app = wx.App()
    frame = MainFrame()
    frame.Show()
    app.MainLoop()